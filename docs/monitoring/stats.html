<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Runtime Stats &#8212; Velox  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=0f882399" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PyVelox: Python bindings and extensions for Velox" href="../bindings/python/README_generated_pyvelox.html" />
    <link rel="prev" title="Runtime Metrics" href="metrics.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../bindings/python/README_generated_pyvelox.html" title="PyVelox: Python bindings and extensions for Velox"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="metrics.html" title="Runtime Metrics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../monitoring.html" accesskey="U">Monitoring</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Runtime Stats</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="runtime-stats">
<h1>Runtime Stats<a class="headerlink" href="#runtime-stats" title="Link to this heading">¶</a></h1>
<p>Runtime stats are used to collect the per-query velox runtime events for
offline query analysis purpose. The collected stats can provide insights into
the operator level query execution internals, such as how much time a query
operator spent in disk spilling. The collected stats are organized in a
free-form key-value for easy extension. The key is the event name and the
value is defined as RuntimeCounter which is used to store and aggregate a
particular event occurrences during the operator execution. RuntimeCounter has
three types: kNone used to record event count, kNanos used to record event time
in nanoseconds and kBytes used to record memory or storage size in bytes. It
records the count of events, and the min/max/sum of the event values. The stats
are stored in OperatorStats structure. The query system can aggregate the
operator level stats collected from each driver by pipeline and task for
analysis.</p>
<section id="memory-arbitration">
<h2>Memory Arbitration<a class="headerlink" href="#memory-arbitration" title="Link to this heading">¶</a></h2>
<p>These stats are reported by all operators.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stats</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>memoryReclaimCount</p></td>
<td></td>
<td><p>The number of times that the memory arbitration to reclaim memory from
an spillable operator.
This stats only applies for spillable operators.</p></td>
</tr>
<tr class="row-odd"><td><p>memoryReclaimWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The memory reclaim execution time of an operator during the memory
arbitration. It collects time spent on disk spilling or file write.
This stats only applies for spillable operators.</p></td>
</tr>
<tr class="row-even"><td><p>reclaimedMemoryBytes</p></td>
<td><p>bytes</p></td>
<td><p>The reclaimed memory bytes of an operator during the memory arbitration.
This stats only applies for spillable operators.</p></td>
</tr>
<tr class="row-odd"><td><p>globalArbitrationCount</p></td>
<td></td>
<td><p>The number of times a request for more memory hit the arbitrator’s
capacity limit and initiated a global arbitration attempt where
memory is reclaimed from viable candidates chosen among all running
queries based on a criterion.</p></td>
</tr>
<tr class="row-even"><td><p>localArbitrationCount</p></td>
<td></td>
<td><p>The number of times a request for more memory hit the query memory
limit and initiated a local arbitration attempt where memory is
reclaimed from the requestor itself.</p></td>
</tr>
<tr class="row-odd"><td><p>localArbitrationQueueWallNanos</p></td>
<td></td>
<td><p>The time of an operator waiting in local arbitration queue.</p></td>
</tr>
<tr class="row-even"><td><p>localArbitrationLockWaitWallNanos</p></td>
<td></td>
<td><p>The time of an operator waiting to acquire the local arbitration lock.</p></td>
</tr>
<tr class="row-odd"><td><p>globalArbitrationLockWaitWallNanos</p></td>
<td></td>
<td><p>The time of an operator waiting to acquire the global arbitration lock.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="hashbuild-hashaggregation">
<h2>HashBuild, HashAggregation<a class="headerlink" href="#hashbuild-hashaggregation" title="Link to this heading">¶</a></h2>
<p>These stats are reported only by HashBuild and HashAggregation operators.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stats</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>hashtable.capacity</p></td>
<td></td>
<td><p>Number of slots across all buckets in the hash table.</p></td>
</tr>
<tr class="row-odd"><td><p>hashtable.numRehashes</p></td>
<td></td>
<td><p>Number of rehash() calls.</p></td>
</tr>
<tr class="row-even"><td><p>hashtable.numDistinct</p></td>
<td></td>
<td><p>Number of distinct keys in the hash table.</p></td>
</tr>
<tr class="row-odd"><td><p>hashtable.numTombstones</p></td>
<td></td>
<td><p>Number of tombstone slots in the hash table.</p></td>
</tr>
<tr class="row-even"><td><p>hashtable.buildWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>Time spent on building the hash table from rows collected by all the
hash build operators. This stat is only reported by the HashBuild operator.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tablewriter">
<h2>TableWriter<a class="headerlink" href="#tablewriter" title="Link to this heading">¶</a></h2>
<p>These stats are reported only by TableWriter operator</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stats</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>earlyFlushedRawBytes</p></td>
<td><p>bytes</p></td>
<td><p>Number of bytes pre-maturely flushed from file writers because of memory reclaiming.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="spilling">
<h2>Spilling<a class="headerlink" href="#spilling" title="Link to this heading">¶</a></h2>
<p>These stats are reported by operators that support spilling.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40.0%" />
<col style="width: 20.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stats</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>spillFillWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on filling rows for spilling.</p></td>
</tr>
<tr class="row-odd"><td><p>spillSortWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on sorting rows for spilling.</p></td>
</tr>
<tr class="row-even"><td><p>spillExtractVectorWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on extracting Vector from RowContainer for spilling.</p></td>
</tr>
<tr class="row-odd"><td><p>spillSerializationWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on serializing rows for spilling.</p></td>
</tr>
<tr class="row-even"><td><p>spillFlushWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on copy out serialized rows for disk write. If compression
is enabled, this includes the compression time.</p></td>
</tr>
<tr class="row-odd"><td><p>spillWrites</p></td>
<td></td>
<td><p>The number of spill writer flushes, equivalent to number of write calls to
underlying filesystem.</p></td>
</tr>
<tr class="row-even"><td><p>spillWriteWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on writing spilled rows to disk.</p></td>
</tr>
<tr class="row-odd"><td><p>spillRuns</p></td>
<td></td>
<td><p>The number of times that spilling runs on an operator.</p></td>
</tr>
<tr class="row-even"><td><p>exceededMaxSpillLevel</p></td>
<td></td>
<td><p>The number of times that an operator exceeds the max spill limit.</p></td>
</tr>
<tr class="row-odd"><td><p>spillReadBytes</p></td>
<td><p>bytes</p></td>
<td><p>The number of bytes read from spilled files.</p></td>
</tr>
<tr class="row-even"><td><p>spillReads</p></td>
<td></td>
<td><p>The number of spill reader reads, equivalent to the number of read calls to the underlying filesystem.</p></td>
</tr>
<tr class="row-odd"><td><p>spillReadWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on read data from spilled files.</p></td>
</tr>
<tr class="row-even"><td><p>spillDeserializationWallNanos</p></td>
<td><p>nanos</p></td>
<td><p>The time spent on deserializing rows read from spilled files.</p></td>
</tr>
</tbody>
</table>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Runtime Stats</a><ul>
<li><a class="reference internal" href="#memory-arbitration">Memory Arbitration</a></li>
<li><a class="reference internal" href="#hashbuild-hashaggregation">HashBuild, HashAggregation</a></li>
<li><a class="reference internal" href="#tablewriter">TableWriter</a></li>
<li><a class="reference internal" href="#spilling">Spilling</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="metrics.html"
                          title="previous chapter">Runtime Metrics</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../bindings/python/README_generated_pyvelox.html"
                          title="next chapter">PyVelox: Python bindings and extensions for Velox</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/monitoring/stats.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../bindings/python/README_generated_pyvelox.html" title="PyVelox: Python bindings and extensions for Velox"
             >next</a> |</li>
        <li class="right" >
          <a href="metrics.html" title="Runtime Metrics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../monitoring.html" >Monitoring</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Runtime Stats</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright TBD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>