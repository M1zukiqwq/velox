<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Conversion Functions &#8212; Velox  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=279e0f84" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="URL Functions" href="url.html" />
    <link rel="prev" title="Window functions" href="window.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="url.html" title="URL Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="window.html" title="Window functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" accesskey="U">Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Conversion Functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="conversion-functions">
<h1>Conversion Functions<a class="headerlink" href="#conversion-functions" title="Link to this heading">¶</a></h1>
<p>Casting from UNKNOWN type to all other scalar types is supported, e.g., cast(NULL as int).</p>
<section id="cast-to-integral-types">
<h2>Cast to Integral Types<a class="headerlink" href="#cast-to-integral-types" title="Link to this heading">¶</a></h2>
<p>Integral types include bigint, integer, smallint, and tinyint.</p>
<section id="from-integral-types">
<h3>From integral types<a class="headerlink" href="#from-integral-types" title="Link to this heading">¶</a></h3>
<p>Casting one integral type to another is allowed. When the input value exceeds the range of result type,
a value of the result type is created forcedly with the input value.</p>
<p>Valid examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">1234567</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1234567</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">12</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">12</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">1234</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">46</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">1234567</span> <span class="k">as</span> <span class="n">smallint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">10617</span>
</pre></div>
</div>
</section>
<section id="from-floating-point-types">
<h3>From floating-point types<a class="headerlink" href="#from-floating-point-types" title="Link to this heading">¶</a></h3>
<p>Casting from floating-point input to an integral type truncates the input value.
It is allowed when the truncated result exceeds the range of result type.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">12345.12</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">12345</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">12345.67</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">12345</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">127.1</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">127</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">127.8</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">127</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">1234567.89</span> <span class="k">as</span> <span class="n">smallint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">10617</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">9223372036854775807</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">integer</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">smallint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="from-strings">
<h3>From strings<a class="headerlink" href="#from-strings" title="Link to this heading">¶</a></h3>
<p>Casting a string to an integral type is allowed if the string represents a number within the range of result type.
Casting from strings that represent floating-point numbers truncates the decimal part of the input value.
Casting from invalid input values throws.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;12345&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">12345</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;+1&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;12345.67&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">12345</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1.2&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-1.8&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;+1&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1.&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-1.&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;0.&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-.&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Invalid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1234567&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Out</span> <span class="n">of</span> <span class="nb">range</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1a&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1,234,567&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="mi">234</span><span class="s1">&#39;567&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;infinity&#39;</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
</pre></div>
</div>
</section>
<section id="from-decimal">
<h3>From decimal<a class="headerlink" href="#from-decimal" title="Link to this heading">¶</a></h3>
<p>The decimal part will be truncated for casting to an integer.
It is allowed when the truncated result exceeds the range of result type.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">2.56</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">3.46</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">3</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">5500.0</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">124</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">2147483648.90</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">2147483648.90</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">as</span> <span class="n">integer</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">2147483648</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">2147483648.90</span> <span class="k">as</span> <span class="n">DECIMAL</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2147483648</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-boolean">
<h2>Cast to Boolean<a class="headerlink" href="#cast-to-boolean" title="Link to this heading">¶</a></h2>
<section id="from-varchar">
<h3>From VARCHAR<a class="headerlink" href="#from-varchar" title="Link to this heading">¶</a></h3>
<p>The strings <cite>t, f, y, n, 1, 0, yes, no, true, false</cite> and their upper case equivalents are allowed to be casted to boolean.
Casting from other strings to boolean throws.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;0&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;true&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;f&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;false&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;y&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;yes&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;n&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;no&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span> <span class="p">(</span><span class="n">case</span> <span class="n">insensitive</span><span class="p">)</span>
</pre></div>
</div>
<p>Invalid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1.7E308&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;infinity&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;12&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;tru&#39;</span> <span class="k">as</span> <span class="n">boolean</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-string">
<h2>Cast to String<a class="headerlink" href="#cast-to-string" title="Link to this heading">¶</a></h2>
<section id="from-timestamp">
<h3>From TIMESTAMP<a class="headerlink" href="#from-timestamp" title="Link to this heading">¶</a></h3>
<p>Casting a timestamp to a string returns ISO 8601 format with space as separator between date and time,
and the year part is padded with zeros to 4 characters.
The conversion precision is microsecond, and trailing zeros are not appended.
When the year exceeds 9999, a positive sign is added.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01-01 00:00:00&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;1970-01-01 00:00:00&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2000-01-01 12:21:56.129&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;2000-01-01 12:21:56.129&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2000-01-01 12:21:56.100000&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;2000-01-01 12:21:56.1&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2000-01-01 12:21:56.129900&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;2000-01-01 12:21:56.1299&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;10000-02-01 16:00:00.000&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;+10000-02-01 16:00:00&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;0384-01-01 08:00:00.000&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;0384-01-01 08:00:00&#39;</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-0010-02-01 10:00:00.000&#39;</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">)</span> <span class="k">as</span> <span class="n">string</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;-0010-02-01 10:00:00&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-date">
<h2>Cast to Date<a class="headerlink" href="#cast-to-date" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3>From strings<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>All Spark supported patterns are allowed:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[+-](YYYY-MM-DD)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[+-]yyyy*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[+-]yyyy*-[m]m</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[+-]yyyy*-[m]m-[d]d</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[+-]yyyy*-[m]m-[d]d</span> <span class="pre">*</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[+-]yyyy*-[m]m-[d]dT*</span></code></p></li>
</ul>
</div></blockquote>
<p>The asterisk <code class="docutils literal notranslate"><span class="pre">*</span></code> in <code class="docutils literal notranslate"><span class="pre">yyyy*</span></code> stands for any numbers.
For the last two patterns, the trailing <code class="docutils literal notranslate"><span class="pre">*</span></code> can represent none or any sequence of characters, e.g:</p>
<blockquote>
<div><ul class="simple">
<li><p>“1970-01-01 123”</p></li>
<li><p>“1970-01-01 (BC)”</p></li>
</ul>
</div></blockquote>
<p>All leading and trailing UTF8 white-spaces will be trimmed before cast.
Casting from invalid input values throws.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01-01&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01-01T123&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01-01 &#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1970-01-01 (BC)&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
</pre></div>
</div>
<p>Invalid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2012-Oct-23&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2012/10/23&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2012.10.23&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">);</span> <span class="o">--</span> <span class="n">Invalid</span> <span class="n">argument</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-decimal">
<h2>Cast to Decimal<a class="headerlink" href="#cast-to-decimal" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3>From varchar<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Casting varchar to a decimal of given precision and scale is allowed.
The behavior is similar with Presto except Spark allows leading and trailing white-spaces in input varchars.</p>
<p>Valid example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39; 1.23&#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;1.23 &#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;  1.23  &#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39; -3E+2&#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="o">--</span> <span class="o">-</span><span class="mf">300.00</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;-3E+2 &#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="o">--</span> <span class="o">-</span><span class="mf">300.00</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;  -3E+2  &#39;</span> <span class="k">as</span> <span class="n">decimal</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="o">--</span> <span class="o">-</span><span class="mf">300.00</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-varbinary">
<h2>Cast to Varbinary<a class="headerlink" href="#cast-to-varbinary" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3>From integral types<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>Casting integral value to varbinary type is allowed.
Bytes of input value are converted into an array of bytes in little-endian order.
Supported types are tinyint, smallint, integer and bigint.</p>
<p>Valid example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mi">18</span> <span class="k">as</span> <span class="n">tinyint</span><span class="p">)</span> <span class="k">as</span> <span class="n">binary</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mi">180</span> <span class="k">as</span> <span class="n">smallint</span><span class="p">)</span> <span class="k">as</span> <span class="n">binary</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="mi">00</span> <span class="n">B4</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mi">180000</span> <span class="k">as</span> <span class="n">integer</span><span class="p">)</span> <span class="k">as</span> <span class="n">binary</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">02</span> <span class="n">BF</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mi">180000</span> <span class="k">as</span> <span class="n">bigint</span><span class="p">)</span> <span class="k">as</span> <span class="n">binary</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">02</span> <span class="n">BF</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="cast-to-timestamp">
<h2>Cast to Timestamp<a class="headerlink" href="#cast-to-timestamp" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3>From integral types<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Casting integral value to timestamp type is allowed.
The input value is treated as the number of seconds since the epoch (1970-01-01 00:00:00 UTC).
Supported types are tinyint, smallint, integer and bigint.</p>
<p>Valid example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">0</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">1727181032</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">32</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mi">9223372036855</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">294247</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">10</span> <span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">54.775807</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="o">-</span><span class="mi">9223372036855</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">290308</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">21</span> <span class="mi">19</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">05.224192</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>From floating-point types<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Casting from floating-point input to timestamp type is allowed.
The input value is treated as the number of seconds since the epoch (1970-01-01 00:00:00 UTC) and converted to microseconds by truncating the fractional part.</p>
<p>Valid examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">0.0</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="mf">1727181032.0</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2024</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">32</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="o">-</span><span class="mf">1727181032.0</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1915</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">09</span> <span class="mi">11</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">28</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">9223372036855.999</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">294247</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">10</span> <span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">54.775807</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="o">-</span><span class="mf">9223372036856.999</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">290308</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">21</span> <span class="mi">19</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">05.224192</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mf">1.79769e+308</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="mi">294247</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">10</span> <span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">54.775807</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span> <span class="k">as</span> <span class="n">double</span><span class="p">)</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Conversion Functions</a><ul>
<li><a class="reference internal" href="#cast-to-integral-types">Cast to Integral Types</a><ul>
<li><a class="reference internal" href="#from-integral-types">From integral types</a></li>
<li><a class="reference internal" href="#from-floating-point-types">From floating-point types</a></li>
<li><a class="reference internal" href="#from-strings">From strings</a></li>
<li><a class="reference internal" href="#from-decimal">From decimal</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-boolean">Cast to Boolean</a><ul>
<li><a class="reference internal" href="#from-varchar">From VARCHAR</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-string">Cast to String</a><ul>
<li><a class="reference internal" href="#from-timestamp">From TIMESTAMP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-date">Cast to Date</a><ul>
<li><a class="reference internal" href="#id1">From strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-decimal">Cast to Decimal</a><ul>
<li><a class="reference internal" href="#id2">From varchar</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-varbinary">Cast to Varbinary</a><ul>
<li><a class="reference internal" href="#id3">From integral types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cast-to-timestamp">Cast to Timestamp</a><ul>
<li><a class="reference internal" href="#id4">From integral types</a></li>
<li><a class="reference internal" href="#id5">From floating-point types</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="window.html"
                          title="previous chapter">Window functions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="url.html"
                          title="next chapter">URL Functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/functions/spark/conversion.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="url.html" title="URL Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="window.html" title="Window functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" >Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Conversion Functions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright TBD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.1.
    </div>
  </body>
</html>